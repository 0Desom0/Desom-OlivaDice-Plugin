- **名称**：`德州扑克`
- **作者**：`Desom-fu`
- **版本**：`1.0.0`
- **兼容版本**：`理论兼容所有 3.0 以上的 OlivOS 版本`
- **平台**：`理论支持能够私聊的全平台（仅在 QQ 部署测试）`
- **前置插件**：`OlivaDiceCore`

---

## 简介

本插件在群聊中提供一局多人德州扑克（Texas Hold'em）对局：建局、入座、发牌、盲注、四轮下注、公共牌、摊牌与边池结算。

---

## 下载

- ### 插件包（注意解压！！！）：
[upl-file uuid=38443831-dab8-4715-a42f-81103fe73d2f size=15kB]liarbar.zip[/upl-file]

---

## 注意事项

- 本插件的操作在群内进行，**底牌通过私聊发送**。
- QQ 平台若未添加 bot 为好友，无法使用本插件（插件会拦截并提示），其他平台暂未做检测。

---

## 命令总览（前缀：.dz 或 .th）

### 建局/入场
- `.dz 创建 [底注]`：创建房间（默认 1000；必须为 1000 倍数）
- `.dz 加入 [携带筹码]`：加入游戏（默认=底注；必须>大盲注；允许同一 QQ 多次加入占不同座位）
- `.dz 退出`：仅开局前退出（若同一 QQ 多座位，按后加入先退出）
- `.dz 开始`：至少 2 人开始，发牌并扣盲注
- `.dz 解散`：仅开局前（权限：座位 1/管理员/群主/骰主）

### 回合操作
- `.dz 看牌`：群聊触发，bot 私聊返回手牌
- `.dz 跟` / `.dz 跟注`
- `.dz 过` / `.dz 过牌`
- `.dz 下 [数值]`：翻牌后且无人下注时
- `.dz 加 [数值]`：可不带数字，默认=最小加注
- `.dz 全压` / `.dz 梭哈`
- `.dz 弃` / `.dz 弃牌`
- `.dz 离场`：强行弃牌+净身出户，筹码充公入池并移除座位

### 全局/管理
- `.dz 局势`：查看当前局面
- `.dz 结束`：开启结束开关，本手结算后结束游戏（不会自动开始下一手）
- `.dz 踢 [座位号]`：踢人（权限：管理员/群主/骰主；逻辑同离场）
- `.dz 强制结束` / `.dz halt` / `.dz stop`：立即销毁数据，不结算（权限：管理员/群主/骰主）

---

## 规则

### 基本玩法
- 人数：2-10 人。
- 牌局流程：发两张底牌（私聊）→ 盲注 → 四轮下注（翻牌前 / 翻牌 / 转牌 / 河牌）→ 摊牌结算。
- 公共牌：翻牌发 3 张，转牌 1 张，河牌 1 张。
- 手牌评估：从“2 张底牌 + 5 张公共牌”的 7 张牌中，选最强 5 张组成牌型。

### 盲注与轮转
- 开始一手时自动扣小盲/大盲，并进入翻牌前行动。
- 庄位每手轮转；位置名称（BTN/SB/BB/UTG...）按庄位顺时针计算。

### 下注与行动
- 轮到你行动时，群内用指令操作；底牌查看使用 `.dz 看牌`（触发私聊）。
- 常见动作：
	- 过牌：当前你不需要跟注且无人下注时可用。
	- 跟注：补齐到当前需要跟到的额度。
	- 下注：翻牌后且当前无人下注时，用 `.dz 下 [数值]`。
	- 加注：用 `.dz 加 [数值]`；可省略数值表示“按最小加注”。
	- 全压：`.dz 全压`（把剩余筹码一次性投入）。
	- 弃牌：`.dz 弃牌`（放弃争夺本手所有底池）。

### 全压、边池与“未被跟注返还”
- 若出现不同玩家投入额度不同，会按投入额度自动拆分为“主池/边池”。
- **未被跟注的超额投入会返还**：例如 A 全压 1000，B 只能跟到 200，则 A 的多出来 800 属于未被跟注金额，会退回给 A（并在摊牌明细中显示“退还”）。
- 只要某一层底池存在至少 2 名可争夺玩家，就会按牌力结算，不会返还。

### 摊牌与结算
- 当所有仍在手牌的玩家都无需继续行动（包括全员全压）时，会自动补齐公共牌并进入摊牌。
- 摊牌会展示：公共牌、每位玩家底牌/凑牌/牌型、各奖池赢家与赢得金额；平分时余数会按固定规则分配（保证结果确定）。

---

## 规则入口

- 规则：使用 `.help texas_rule` 查看。
- 牌型比较：使用 `.help texas_rank` 查看。

---

## 使用示例

```
.dz 创建 1000
.dz 加入 5000
.dz 加入 5000
.dz 开始
.dz 看牌
.dz 局势
.dz 跟
.dz 弃牌
```

---

## 安装

1. 将 `TexasHoldem.opk` 放入 OlivOS 插件目录：`YourOlivOSPath/plugin/app`。
2. 重载插件。

---

## 更新日志

### 2026.1.10 v1.0.0
- 初版发布（群聊对局 + 私聊发牌/看牌 + 盲注/轮转/边池结算）。

---

## 截图演示
![Image description](https://forum.olivos.run/assets/files/2026-01-10/1768047651-338574-9c96d1d20eb8a4f64cac64ff5518efab-720.jpg)

